/**
 * English to Chinese category mapping for MACCMS API
 * Based on cn.pornhub.com category names with consolidation for gay categories
 */

// Comprehensive category mapping
export const CATEGORY_MAPPING: Record<string, string> = {
  // CUSTOM CATEGORIES (Keep separate from asian)
  'japanese': '日本',
  'chinese': '中文',

  // MAIN CATEGORIES
  'amateur': '业余',
  'anal': '肛交',
  'asian': '亚洲',
  'babe': '风情少女',
  'bbw': '大码美女',
  'big-ass': '大屁股',
  'big-dick': '巨屌',
  'big-tits': '大奶',
  'blonde': '金发女',
  'blowjob': '口交',
  'brunette': '黑发女',
  'creampie': '内射',
  'cumshot': '射精',
  'ebony': '黑人',
  'fetish': '恋物癖',
  'gangbang': '轮奸',
  'hardcore': '劲爆重口味',
  'hentai': '动漫',
  'interracial': '异族',
  'latina': '拉丁',
  'lesbian': '女同性恋',
  'masturbation': '自慰',
  'mature': '成熟',
  'milf': '熟女',
  'orgy': '群交',
  'pornstar': '色情明星',
  'pov': '第一视角',
  'public': '公共场所',
  'reality': '现实',
  'redhead': '红发女',
  'red-head': '红发女',
  'small-tits': '小奶',
  'squirt': '潮吹',
  'squirting': '潮吹',
  'threesome': '三人行',
  'toys': '玩具',
  'vintage': '复古',
  'webcam': '网络摄像头',

  // SPECIFIC ACTS/TYPES
  'bondage': '束缚',
  'bukkake': '颜射',
  'casting': '选角',
  'compilation': '合集',
  'cosplay': '角色扮演',
  'cuckold': '戴绿帽',
  'double-penetration': '双插',
  'fingering': '指交',
  'fisting': '拳交',
  'handjob': '手交',
  'massage': '按摩',
  'party': '派对',
  'pussy-licking': '舔阴',
  'role-play': '角色扮演',
  'rough-sex': '粗暴性爱',
  'scissoring': '磨镜',
  'smoking': '吸烟',
  'solo-female': '女性自慰',
  'solo-male': '男性自慰',
  'step-fantasy': '继家庭幻想',
  'strap-on': '假阳具',
  'striptease': '脱衣舞',

  // AGE/BODY TYPES
  '18-25': '18-25岁',
  'babysitter-18': '保姆',
  'college-18': '大学生',
  'college-18-1': '大学生',
  'muscular-men': '肌肉男',
  'old-young-18': '老少配',
  'school-18': '学生',
  'tattooed-men': '纹身男',
  'tattooed-women': '纹身女',
  'twink-18': '小鲜肉',

  // QUALITY/FORMAT
  '3d': '3D',
  '60fps-1': '60帧',
  '180-1': '180度',
  '360-1': '360度',
  'hd-porn': '高清',
  'interactive': '互动',
  'uncensored': '无码',
  'uncensored-1': '无码',
  'virtual-reality-1': '虚拟现实',
  'vr': '虚拟现实',
  'closed-captions': '字幕',

  // VERIFIED/EXCLUSIVE
  'behind-the-scenes': '幕后花絮',
  'described-video': '描述视频',
  'exclusive': '独家',
  'verified-amateurs': '认证业余',
  'verified-couples': '认证情侣',
  'verified-models': '认证模特',

  // REGIONAL
  'arab': '阿拉伯',
  'brazilian': '巴西',
  'british': '英国',
  'czech': '捷克',
  'euro': '欧洲',
  'french': '法国',
  'german': '德国',
  'indian': '印度',
  'italian': '意大利',
  'korean': '韩国',
  'russian': '俄罗斯',

  // ORIENTATION SPECIFIC
  'bisexual-male': '双性恋男',
  'female-orgasm': '女性高潮',
  'ffm': '两女一男',
  'fmm': '两男一女',
  'popular-with-women': '女性喜爱',
  'romantic': '浪漫',
  'transgender': '跨性别',
  'trans-male': '跨性别男',
  'trans-with-girl': '跨性别与女',
  'trans-with-guy': '跨性别与男',

  // OTHER
  'cartoon': '卡通',
  'celebrity': '名人',
  'feet': '足交',
  'funny': '搞笑',
  'gaming': '游戏',
  'music': '音乐',
  'parody': '恶搞',
  'pissing': '尿尿',
  'podcast': '播客',
  'sfw': '安全内容',
  'unknown': '未知',

  // === GAY CATEGORIES (All consolidated to 同性恋) ===
  'gay': '同性恋',
  'amateur-gay': '同性恋',
  'asian-gay': '同性恋',
  'bareback-gay': '同性恋',
  'bear-gay': '同性恋',
  'big-dick-gay': '同性恋',
  'black-gay': '同性恋',
  'blowjob-gay': '同性恋',
  'cartoon-gay': '同性恋',
  'casting-gay': '同性恋',
  'chubby-gay': '同性恋',
  'closed-captions-gay': '同性恋',
  'compilation-gay': '同性恋',
  'creampie-gay': '同性恋',
  'cumshot-gay': '同性恋',
  'daddy-gay': '同性恋',
  'euro-gay': '同性恋',
  'feet-gay': '同性恋',
  'fetish-gay': '同性恋',
  'group-gay': '同性恋',
  'handjob-gay': '同性恋',
  'hd-porn-gay': '同性恋',
  'hunks-gay': '同性恋',
  'interracial-gay': '同性恋',
  'japanese-gay': '同性恋',
  'jock-gay': '同性恋',
  'latino-gay': '同性恋',
  'massage-gay': '同性恋',
  'mature-gay': '同性恋',
  'military-gay': '同性恋',
  'muscle-gay': '同性恋',
  'pornstar-gay': '同性恋',
  'pov-gay': '同性恋',
  'pov-1': '同性恋',
  'public-gay': '同性恋',
  'reality-gay': '同性恋',
  'rough-sex-gay': '同性恋',
  'solo-male-gay': '同性恋',
  'straight-guys-gay': '同性恋',
  'tattooed-men-gay': '同性恋',
  'uncut-gay': '同性恋',
  'verified-amateurs-gay': '同性恋',
  'vintage-gay': '同性恋',
  'webcam-gay': '同性恋',
}

/**
 * Category consolidation rules for MACCMS
 * Maps specific categories to broader ones to reduce clutter
 *
 * SPECIAL CATEGORIES (NEVER CONSOLIDATE):
 * - japanese: Keep separate (custom category)
 * - chinese: Keep separate (custom category)
 */
export const CATEGORY_CONSOLIDATION: Record<string, string> = {
  // === ALL GAY VARIANTS → gay ===
  'amateur-gay': 'gay',
  'asian-gay': 'gay',
  'bareback-gay': 'gay',
  'bear-gay': 'gay',
  'big-dick-gay': 'gay',
  'black-gay': 'gay',
  'blowjob-gay': 'gay',
  'cartoon-gay': 'gay',
  'casting-gay': 'gay',
  'chubby-gay': 'gay',
  'closed-captions-gay': 'gay',
  'compilation-gay': 'gay',
  'creampie-gay': 'gay',
  'cumshot-gay': 'gay',
  'daddy-gay': 'gay',
  'euro-gay': 'gay',
  'feet-gay': 'gay',
  'fetish-gay': 'gay',
  'group-gay': 'gay',
  'handjob-gay': 'gay',
  'hd-porn-gay': 'gay',
  'hunks-gay': 'gay',
  'interracial-gay': 'gay',
  'japanese-gay': 'gay',
  'jock-gay': 'gay',
  'latino-gay': 'gay',
  'massage-gay': 'gay',
  'mature-gay': 'gay',
  'military-gay': 'gay',
  'muscle-gay': 'gay',
  'pornstar-gay': 'gay',
  'pov-gay': 'gay',
  'pov-1': 'gay',
  'public-gay': 'gay',
  'reality-gay': 'gay',
  'rough-sex-gay': 'gay',
  'solo-male-gay': 'gay',
  'straight-guys-gay': 'gay',
  'tattooed-men-gay': 'gay',
  'uncut-gay': 'gay',
  'verified-amateurs-gay': 'gay',
  'vintage-gay': 'gay',
  'webcam-gay': 'gay',

  // === HAIR COLOR → blonde ===
  'red-head': 'blonde',
  'redhead': 'blonde',
  'brunette': 'blonde',

  // === BODY TYPES → bbw ===
  'babe': 'bbw',
  'big-ass': 'bbw',
  'big-tits': 'bbw',
  'small-tits': 'bbw',

  // === SEX ACTS → hardcore ===
  'anal': 'hardcore',
  'blowjob': 'hardcore',
  'handjob': 'hardcore',
  'fingering': 'hardcore',
  'pussy-licking': 'hardcore',
  'rough-sex': 'hardcore',
  'double-penetration': 'hardcore',
  'fisting': 'hardcore',
  'gangbang': 'hardcore',

  // === CUMSHOTS → cumshot ===
  'creampie': 'cumshot',
  'bukkake': 'cumshot',
  'squirt': 'cumshot',
  'squirting': 'cumshot',

  // === AGE/STUDENT → college-18 ===
  'college-18-1': 'college-18',
  '18-25': 'college-18',
  'school-18': 'college-18',
  'babysitter-18': 'college-18',
  'twink-18': 'college-18',

  // === MATURE → mature ===
  'milf': 'mature',
  'old-young-18': 'mature',

  // === QUALITY/FORMAT → hd-porn ===
  '60fps-1': 'hd-porn',
  '3d': 'hd-porn',
  'uncensored': 'hd-porn',
  'uncensored-1': 'hd-porn',
  'closed-captions': 'hd-porn',

  // === VR → vr ===
  'virtual-reality-1': 'vr',
  '180-1': 'vr',
  '360-1': 'vr',
  'interactive': 'vr',

  // === VERIFIED/EXCLUSIVE → verified-amateurs ===
  'verified-couples': 'verified-amateurs',
  'verified-models': 'verified-amateurs',
  'exclusive': 'verified-amateurs',
  'behind-the-scenes': 'verified-amateurs',

  // === ROLEPLAY → cosplay ===
  'role-play': 'cosplay',
  'step-fantasy': 'cosplay',
  'cuckold': 'cosplay',

  // === SOLO → masturbation ===
  'solo-female': 'masturbation',
  'solo-male': 'masturbation',

  // === REGIONAL → asian ===
  'korean': 'asian',
  'indian': 'asian',
  // NOTE: japanese and chinese are EXCLUDED - they stay separate!

  'arab': 'asian',
  'brazilian': 'latina',
  'french': 'euro',
  'german': 'euro',
  'british': 'euro',
  'italian': 'euro',
  'russian': 'euro',
  'czech': 'euro',

  // === ETHNICITY → interracial ===
  'ebony': 'interracial',
  'latina': 'interracial',

  // === KINK/FETISH → fetish ===
  'bondage': 'fetish',
  'feet': 'fetish',
  'smoking': 'fetish',
  'pissing': 'fetish',
  'strap-on': 'fetish',

  // === MISC → amateur ===
  'reality': 'amateur',
  'casting': 'amateur',
  'webcam': 'amateur',
  'party': 'amateur',
  'public': 'amateur',

  // === ENTERTAINMENT → hentai ===
  'cartoon': 'hentai',
  'parody': 'hentai',
  'funny': 'hentai',
  'gaming': 'hentai',
  'music': 'hentai',
  'podcast': 'hentai',
  'sfw': 'hentai',
  'described-video': 'hentai',

  // === TRANS → transgender ===
  'trans-male': 'transgender',
  'trans-with-girl': 'transgender',
  'trans-with-guy': 'transgender',

  // === THREESOME → threesome ===
  'ffm': 'threesome',
  'fmm': 'threesome',
  'orgy': 'threesome',

  // === OTHER ===
  'big-dick': 'amateur',
  'pornstar': 'amateur',
  'celebrity': 'amateur',
  'compilation': 'amateur',
  'striptease': 'amateur',
  'massage': 'amateur',
  'vintage': 'amateur',
  'romantic': 'amateur',
  'popular-with-women': 'amateur',
  'bisexual-male': 'amateur',
  'female-orgasm': 'masturbation',
  'scissoring': 'lesbian',
  'muscular-men': 'amateur',
  'tattooed-men': 'amateur',
  'tattooed-women': 'amateur',
  'unknown': 'amateur',
}

/**
 * Get Chinese name for an English category with consolidation
 * 1. Consolidates similar categories (e.g., all gay variants → gay)
 * 2. Returns Chinese name from mapping
 * 3. Returns original if no mapping found
 */
export function getCategoryChineseName(englishName: string): string {
  const normalized = englishName.toLowerCase().trim()

  // First check if this category should be consolidated
  const consolidated = CATEGORY_CONSOLIDATION[normalized] || normalized

  // Then get the Chinese name
  const chineseName = CATEGORY_MAPPING[consolidated]
  if (chineseName) return chineseName

  // Try with spaces replaced by hyphens
  const hyphenated = consolidated.replace(/\s+/g, '-')
  const hyphenMatch = CATEGORY_MAPPING[hyphenated]
  if (hyphenMatch) return hyphenMatch

  // Return original if no mapping found
  return englishName
}

/**
 * Get English name from Chinese category
 * Returns original name if no mapping found
 */
export function getCategoryEnglishName(chineseName: string): string {
  const entry = Object.entries(CATEGORY_MAPPING).find(([, chinese]) => chinese === chineseName)
  return entry ? entry[0] : chineseName
}

/**
 * Get the canonical category for a given category name
 * Returns the base category if this is a variant (e.g., 'amateur-gay' → 'gay')
 */
export function getCanonicalCategory(categoryName: string): string {
  const normalized = categoryName.toLowerCase().trim()
  return CATEGORY_CONSOLIDATION[normalized] || normalized
}

/**
 * Get all category names that consolidate to a given canonical category
 * Returns array including the canonical category itself
 */
export function getConsolidatedCategories(canonicalCategory: string): string[] {
  const normalized = canonicalCategory.toLowerCase().trim()
  const variants = Object.entries(CATEGORY_CONSOLIDATION)
    .filter(([, target]) => target === normalized)
    .map(([source]) => source)

  return [normalized, ...variants]
}
